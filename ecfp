import pandas as pd
import numpy as np 
import seaborn as sns
import matplotlib.pylab as plt
from rdkit.Chem import AllChem
from rdkit import Chem
from rdkit.Chem import Descriptors
from rdkit.ML.Descriptors import MoleculeDescriptors 

df = pd.read_excel(r"C:\Users\teffa\OneDrive\Documents\Final Year Project\Disso Current Data\Dataset_1.xlsx")

# generating ECFPs (also known as morgan fps) with 1,024 bit length
ECFP4 = []

for i in range (0, len(df)):
    mol = Chem.MolFromSmiles(df.iloc[i,0]) 
    fp = AllChem.GetMorganFingerprintAsBitVect(mol,2,nBits=1024)
    fp_list = np.unique(fp, return_inverse=True)[1].tolist()
    ECFP4.append(fp_list)
ECFP4 = pd.DataFrame(data= ECFP4)
ECFP4 = pd.concat([ECFP4, df.iloc[:, -1]], axis = 1)
print(ECFP4.head())
print(ECFP4.shape)
